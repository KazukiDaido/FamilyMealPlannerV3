# Development Rules (for Me + Cursor)

このプロジェクトの共通ルールです。  
AI（Cursor）は本ルールに従って、計画→設計→実装→テスト→ドキュメント更新まで一貫して提案・記録を行います。

---

## 0. 基本姿勢
- 小さく作って早く見せる（アジャイル・スモールステップ）
- 作業前に「要件 / 受入基準 / 影響範囲 / 設計メモ」を出すこと
- 変更しやすい設計・小さなコミット・小さなPR
- 進行や仕様は常に `.md` ファイルに記録して残すこと

---

## 1. 開発プロセス
1. **要件定義**
   - ユーザーストーリーを短く書く
   - 受入基準（Doneの定義）をチェックリストにする
   - 非機能要件（パフォーマンス/セキュリティ/UXなど）があれば追記
   - → `docs/requirements.md` に保存

2. **設計（必要最小限）**
   - データ構造（state形/DBスキーマ）
   - 画面遷移（Figmaリンク or テキスト）
   - 責務の分離方針（UIは表示のみ、ルールはロジック層）
   - APIの契約（エンドポイント/メソッド/型）
   - → `docs/design.md` に保存

3. **実装**
   - feature/◯◯ ブランチで作業
   - 差分は PR として提案（mainに直接push禁止）

4. **テスト**
   - 受入基準に沿って自己チェック
   - エラー時の挙動も確認
   - → `docs/test-report.md` に保存

5. **リリース**
   - mainにマージ（Squash推奨）
   - バージョンタグ付け
   - → `CHANGELOG.md` に追記

6. **ふりかえり**
   - 詰まった点・改善点を記録
   - → `docs/retrospective.md` に保存

---

## 2. Git運用
- `main` は常に動く状態。直接コミット禁止
- ブランチ命名：
  - 機能: `feature/<説明>` 例) `feature/dinner-attendance`
  - 修正: `bugfix/<説明>`
- フロー：
  1. `git switch -c feature/...`
  2. 小さな意味単位でコミット
  3. PR作成（要約＋スクショ＋受入基準自己チェック）
  4. レビュー後 Squash merge
- 事故対応：
  - `git revert <commit>` = 直前取り消し
  - `git reset --hard <commit>` = ローカル巻き戻し（注意）

---

## 3. コード規約
- 名前は意味が伝わる英語（例：`lockTime`, `toggleAttendance`）
- UIは表示だけ。ビジネスルールは別関数へ
- 型エラーやLintエラーは0にしてからコミット
- エラーハンドリング必須（try/catchや`if (!data)`など）

---

## 4. ドキュメント
- **README.md**（AIがPRで更新提案）
  - 概要・機能リスト・技術スタック
  - セットアップ手順
  - スクショ/動画リンク
  - ロードマップ（次の機能）

- **CHANGELOG.md**
  - バージョンごとに変更点を記録

- **/docs フォルダ**
  - `requirements.md` = 要件定義
  - `design.md` = 設計メモ
  - `test-report.md` = テスト結果
  - `retrospective.md` = ふりかえり
  - `troubleshooting.md` = エラー原因と解決法の蓄積

---

## 5. Issue テンプレ
- 概要  
- 背景  
- 受入基準  
- スクショ or モック  
- テスト観点  
- 影響範囲  

---

## 6. プロジェクト固有追記
- 認証方式（例：メール+パスワード、OAuthなど）
- 課金/収益化方針（例：サブスク、広告）
- 配布手順（App Store, Google Play）
- インフラ（Firebase, Supabase など）
- セキュリティ要件

---

## 7. AIへの指示（Cursor用）
- この rules.md を常に参照し、作業開始時に **Task Header** を提示すること
- 計画→設計→差分→テスト手順→ドキュ更新まで一貫して出すこと
- 進捗や結果は `.md` ファイルに追記して記録すること
- 新しいルールや知見が出たら、自ら `rules.md` や `docs/*.md` に提案を追記すること
